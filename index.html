<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Wikitype</title>
        <!-- FIXME: Only load the fonts if the theme is actually selected. -->
        <link rel="stylesheet" type="text/css"
              href="https://server.xpr.org/~/fonts/gt_america.css">
        <link rel="stylesheet" type="text/css"
              href="https://server.xpr.org/~/fonts/grafier.css">
        <link rel="stylesheet" type="text/css"
              href="https://server.xpr.org/~/fonts/trash.css">
        <link rel="stylesheet" type="text/css"
              href="https://server.xpr.org/~/fonts/inter.css">
        <link rel="stylesheet" type="text/css"
              href="https://server.xpr.org/~/fonts/object_sans.css">
        <link rel="stylesheet" type="text/css"
              href="https://server.xpr.org/~/fonts/jetbrains_mono.css">
        <link rel="stylesheet" type="text/css" href="style.css">
        <script defer data-domain="xpr.org"
                src="https://plausible.io/js/plausible.js"></script>
    </head>
    <body>
        <nav data-is-visible>
            <div id="navSelect">
                <div class="navOption">
                    <span data-navOptionIdx="0"></span>
                    <span class="navOptionTitle">Random Article</span></div>
                <div class="navOption" data-status="loading">
                    <span data-navOptionIdx="1"></span>
                    <span class="navOptionTitle"></span></div>
                <div class="navOption" data-status="loading">
                    <span data-navOptionIdx="2"></span>
                    <span class="navOptionTitle"></span></div>
                <div class="navOption" data-status="loading">
                    <span data-navOptionIdx="3"></span>
                    <span class="navOptionTitle"></span></div>
            </div>
        </nav>

        <aside>
            <span class="logo">WIKITYPE</span>
            <span class="clock"></span>
        </aside>

        <header>
            <dl id="shortcuts">
                <div>
                    <dt><i><span>⌘</span><span>X</span></i></dt>
                    <dd>Skip Article</dd>
                </div>
                <div>
                    <dt><i><span>⌘</span><span>S</span></i></dt>
                    <dd>Skip Word</dd>
                </div>
                <div>
                    <dt><i><span>⌘</span><span>+</span></i><i><span>⌘</span><span>–</span></i><i><span>⌘</span><span>0</span></i></dt>
                    <dd>Adjust Fontsize</dd>
                </div>
                <div>
                    <dt><i><span>⇥</span></i></dt>
                    <dd>Enlargen Thumbnail</dd>
                </div>
                <div>
                    <dt><i><span>↩</span></i></dt>
                    <dd>Read Article <span>↗⃝</span></dd>
                </div>
                <div>
                    <dt><i><span>⌘</span><span>↩</span></i></dt>
                    <dd>Edit Article <span>↗⃝</span></dd>
                </div>
            </dl>
        </header>

        <img id="articleImage" src="data:," alt/>
        <article data-is-loaded>
            <template id="tokenTemplate">
                <span class="token" data-word></span>
            </template>

            <div id="articleFrame">
                <div id="articleContentWrapper">
                    <span class="inputToken" contenteditable type="text"
                          autocomplete="off" autocorrect="off" spellcheck="false"
                          data-mistyped></span>
                    <div id="articleOverflow">
                        <p id="articleExtract"></p>
                        <img id="articleThumbnail" src="data:," alt/>
                    </div>
                </div>
            </div>
        </article>

        <footer>
            <template id="historyEntryTemplate">
                <li data-pageid=""><span data-lang=""></span></li>
            </template>
            <ol class="history"></ol>
        </footer>

        <div id="settingsWrapper">
            <div id="settingsWrapperInner">
                <div id="settingsStatusBar">
                    <span id="settingsStatusLanguage"></span>
                    <span>(&)</span>
                    <span id="settingsStatusTheme"></span>
                </div>
                <template id="settingsOptionTemplate">
                    <li class="settingsOption" data-ref></li>
                </template>
                <div id="settings">
                    <h3>Languages</h3>
                    <ol id="language" class="options"></ol>
                    <h3>Theme</h3>
                    <ol id="theme" class="options"></ol>
                    <h3>Links</h3>
                    <ol data-type="link">
                        <a href="https://github.com/xprueg/wikitype" class="settingsOption">GitHub Repository</a>
                        <a href="https://xpr.org" class="settingsOption">xpr.org</a>
                        <a href="https://wikipedia.org" class="settingsOption">Wikipedia</a>
                    </ol>
                </div>
            </div>
        </div>

        <script src="js/lib.js"></script>
        <script src="js/º.js"></script>
        <script src="js/controller.js"></script>
        <script src="js/loading.js"></script>
        <script src="js/shortcut.js"></script>
        <script src="js/settings.js"></script>
        <script src="js/clock.js"></script>
        <script src="js/theme.js"></script>
        <script src="js/history.js"></script>
        <script src="js/wiki.js"></script>
        <script src="js/nav.js"></script>
        <script src="js/article.js"></script>
        <script>
            const entry = new URLSearchParams(location.search).get("entry");
            const api_response = entry
                ? º.req`wikiapi :fetchArticleByFullUrl`(entry)
                : º.req`wikiapi :fetchRandomArticle`();

            api_response.then((article_data_raw) => {
                º.emit`history :push`({ article_data_raw, is_related: false });
                º.emit`article :setContents`(article_data_raw);
            });
        </script>
    </body>
</html>